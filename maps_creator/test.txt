        document.getElementById('download-button').addEventListener('click', function() {
            var mapNode = document.getElementById('mapid');
            var clonedNode = mapNode.cloneNode(true); // clone the map node

            // Add necessary scripts and styles
            var scriptNode = document.createElement('script');
            scriptNode.setAttribute('src', 'https://unpkg.com/leaflet/dist/leaflet.js');
            clonedNode.appendChild(scriptNode);

            var styleNode = document.createElement('link');
            styleNode.setAttribute('rel', 'stylesheet');
            styleNode.setAttribute('href', 'https://unpkg.com/leaflet/dist/leaflet.css');
            clonedNode.appendChild(styleNode);

            // Add Leaflet initialization code
            var initScriptNode = document.createElement('script');
            initScriptNode.textContent = `
                var map = L.map('mapid').setView([51.505, -0.09], 13);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
                    maxZoom: 19,
                }).addTo(map);
            `;
            clonedNode.appendChild(initScriptNode);

            // Add custom JavaScript code
            var customScriptNode = document.createElement('script');
            customScriptNode.textContent = `
                var map = L.map('mapid').setView([51.505, -0.09], 13);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
                    maxZoom: 19,
                }).addTo(map);
                L.marker([51.5, -0.09]).addTo(map)
                    .bindPopup('A pretty CSS3 popup.<br> Easily customizable.')
                    .openPopup();
            `;
            clonedNode.appendChild(customScriptNode);

            var htmlData = clonedNode.outerHTML;
            var dataStr = "data:text/html;charset=utf-8," + encodeURIComponent(htmlData);
            var downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "layer.html");
            document.body.appendChild(downloadAnchorNode); // append the element to the body
            downloadAnchorNode.click(); // simulate a click
            document.body.removeChild(downloadAnchorNode); // remove the element from the body
        });
        

code for static download map in html = need to be changed in png